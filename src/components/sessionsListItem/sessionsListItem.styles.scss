$icon-size: 24px;
$icon-size-small: 16px;

.sessionsListItem {
	display: flex;
	color: $body-font-color;
	margin-bottom: 3px;
	transition: all 0.6s ease;
	animation: appearSessionListItem 300ms ease forwards;
	opacity: 0;

	@for $i from 1 through 15 {
		&:nth-child(#{$i}) {
			animation-delay: $i * 50ms;
		}
	}

	&:first-of-type {
		margin-top: 3px;
	}

	@keyframes appearSessionListItem {
		0% {
			opacity: 0;
			transform: scale(0.98);
		}

		100% {
			opacity: 1;
			transform: scale(1);
		}
	}

	&--active {
		transition: all 0.3s ease;

		.sessionsListItem__content {
			background-color: #fff5f5 !important; // Light red background for active card
			border: 2px solid #da5248 !important; // Dark red border for active card
			transition: all 0.3s ease;

			&:focus-visible {
				outline: $focus-outline;
				border-radius: 4px;
				transition: all 0.6s ease;
			}

			&:hover,
			&:focus,
			&:active {
				background-color: #fff5f5 !important; // Keep light red background on hover for active card
				border: 2px solid #da5248 !important; // Keep dark red border on hover for active card
			}
		}

		// Make tags red when card is active
		.sessionsListItem__topic {
			background-color: #da5248 !important;
		}

		// Make consulting type icons red when card is active
		.sessionsListItem__consultingTypeIcon {
			svg,
			img {
				// Filter to convert black to #da5248 (red)
				// Using filter to change SVG color from black to red
				filter: brightness(0) saturate(100%) invert(26%) sepia(92%) saturate(2000%) hue-rotate(340deg) brightness(0.9) contrast(0.95);
			}
		}
	}

	&:hover {
		cursor: pointer;
	}

	&__content {
		overflow: auto;
		width: 100%;
		padding-left: 20px;
		padding-right: 6px;
		padding-top: 12px;
		margin: 0 $grid-base-two;
		background-color: $white;
		border: 1px solid #ffcccc; // Light red border for all cards
		border-radius: 8px; // Increased border-radius for all cards
		transition: all 0.6s ease;
		position: relative;
		z-index: 10;
		overflow: hidden;
        margin-bottom: 6px;
	


		@include breakpoint($fromMedium) {
			margin: 6px $grid-base-three;
		}

		&:focus-visible {
			outline: $focus-outline;
			border-radius: 4px;
			transition: all 0.6s ease;
		}

		&:hover,
		&:focus,
		&:active {
			@include breakpoint($fromLarge) {
				background-color: $session-list-item-background-active;
				transition: all 0.3s ease;
			}
		}
	}

	&__row {
		display: flex;
		gap: 12px;
		color: var(--skin-color-default, $secondary);

		&:first-child {
			justify-content: space-between;
			color: $tertiary;
			font-size: $font-size-secondary;
			line-height: 16px;
		}

		&:last-child {
			justify-content: space-between;
			min-height: 19px;
		}

		&:not(:last-child) {
			margin-bottom: $grid-base;
		}

		a[role='button'] {
			margin-left: auto;
		}
	}

	&__rowLeft {
		display: flex;
		align-items: center;
		gap: 8px;
		flex: 1;
	}

	&__rowRight {
		display: flex;
		align-items: center;
		gap: 8px;
		flex-shrink: 0;
		position: relative;
		z-index: 1000;
	}

	&__consultingType {
		display: block;
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
	}

	&__date {
		color: $tertiary;
		font-size: $font-size-secondary;
		line-height: 16px;
		white-space: nowrap;
		align-self: flex-end;
	}

	&__menuIcon {
		display: flex;
		align-items: center;
		justify-content: center;
		cursor: pointer;
		width: 24px;
		height: 24px;
		flex-shrink: 0;
		position: relative;

		svg {
			width: 16px;
			height: 16px;
			fill: var(--skin-color-secondary-contrast-safe, $secondary);
		}

		&:hover {
			opacity: 0.7;
		}
	}

	&__dropdown {
		position: fixed !important;
		top: 190px !important;
		right: 40px !important;
		opacity: 1 !important;
		visibility: visible !important;
		box-sizing: border-box;
		background: white !important;
		width: 280px;
		max-width: calc(100vw - 40px);
		border: 2px solid #cc1e1c;
		border-radius: 8px;
		box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
		overflow: hidden;
		z-index: 99999 !important;
		display: flex !important;
		flex-direction: column;
		padding: 10px;

		@media screen and (max-width: 599px) {
			right: auto !important;
			left: 20px !important;
		}
	}

	&__dropdownHeader {
		display: flex;
		flex-direction: column;
		align-items: flex-start;
		padding: 8px 12px 6px 12px;
		width: 100%;
	}

	&__dropdownSubtitle {
		font-size: 12px;
		color: $form-secondary;
		margin: 0 0 4px 0;
		line-height: 1.4;
	}

	&__dropdownTitle {
		font-size: 14px;
		font-weight: 600;
		color: rgba(0, 0, 0, 0.9);
		margin: 0;
		line-height: 1.4;
	}

	&__dropdownDivider {
		width: 100%;
		height: 1px;
		background-color: rgba(204, 30, 28, 0.15);
		margin: 8px 0;
	}

	&__dropdownContent {
		display: flex;
		flex-direction: column;
		width: 100%;
	}

	&__dropdownOption {
		display: flex;
		align-items: flex-start;
		gap: 10px;
		padding: 8px 12px;
		cursor: pointer;
		transition: background-color 0.2s ease;
		border: none;
		background: transparent;
		text-align: left;
		width: 100%;
		border-radius: 4px;
		margin: 0;

		&:hover:not(:disabled) {
			background-color: #f8f8f8;
		}

		&:disabled {
			cursor: not-allowed;
		}

		&--disabled {
			cursor: not-allowed;
			opacity: 0.6;
		}
	}

	&__dropdownOptionIcon {
		width: 20px;
		height: 20px;
		flex-shrink: 0;
		fill: $form-secondary;
		margin-top: 2px;

		&--disabled {
			fill: rgba(0, 0, 0, 0.5);
			opacity: 0.7;
		}
	}

	&__dropdownOptionCenter {
		flex: 1;
		min-width: 0;
		display: flex;
		flex-direction: column;
		gap: 2px;
	}

	&__dropdownOptionTitleRow {
		display: flex;
		align-items: center;
		justify-content: space-between;
		width: 100%;
	}

	&__dropdownOptionTitle {
		font-size: 14px;
		font-weight: 500;
		color: rgba(0, 0, 0, 0.9);
		line-height: 1.4;
		flex: 1;

		&--disabled {
			color: rgba(0, 0, 0, 0.5);
			opacity: 0.7;
		}
	}

	&__dropdownOptionShortcut {
		display: inline-flex;
		align-items: center;
		justify-content: flex-end;
		font-size: 12px;
		font-weight: 400;
		color: $form-primary;
		background: transparent;
		border: none;
		padding: 0;
		margin: 0;
		font-family: inherit;
	}

	&__dropdownOptionDescription {
		font-size: 12px;
		color: $form-secondary;
		line-height: 1.4;
		margin: 0;

		&--disabled {
			color: rgba(0, 0, 0, 0.5);
			opacity: 0.7;
		}
	}

	&__topic {
		border-radius: 4px;
		padding-left: 8px;
		padding-right: 8px;
		text-align: center;
		color: #fff;
		background-color: var(--skin-color-primary, #646D78);
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
	}

	&__icon {
		width: 48px; // Increased to accommodate stacked avatars
		height: 32px;
		min-width: 48px; // Increased to accommodate stacked avatars
		margin-right: $grid-base;
		display: flex;
		align-items: center;
		justify-content: center;
		margin-right: -12px;

		svg {
			width: $icon-size;
			height: $icon-size;
		}
	}

	&__stackedAvatars {
		position: relative;
		width: 48px; // Wider to accommodate 3 overlapping 32px circles
		height: 32px;
		display: flex;
		align-items: center;
		justify-content: flex-start;
	}

	&__avatarWrapper {
		position: absolute;
		border-radius: 50%;
		border: 2px solid $white;
		overflow: hidden;
		
		&:nth-child(1) {
			right: 16px; // Reversed order - right to left
			top: 0;
			z-index: 1;
		}

		&:nth-child(2) {
			right: 6px; // Reversed order - right to left
			top: 0;
			z-index: 2;
		}

		&:nth-child(3) {
			right: 0; // Reversed order - right to left
			top: 0;
			z-index: 3;
		}

		&--plus {
			background-color: var(--skin-color-primary, #cc1e1c);
			display: flex;
			align-items: center;
			justify-content: center;
			color: $white;
			font-weight: $font-weight-bold;
			font-size: 12px;
		}

		// Ensure the avatar fills the wrapper
		> * {
			display: block;
		}
	}

	&__plusAvatar {
		width: 32px;
		height: 32px;
		display: flex;
		align-items: center;
		justify-content: center;
		font-size: 12px;
		font-weight: $font-weight-bold;
		color: $white;
	}

	&__username {
		font-weight: $font-weight-medium;
		padding-top: 3px;
		margin-right: auto;
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;

		&--readLabel {
			font-weight: $font-weight-regular;
		}
	}

	&__activeLabel {
		padding: 0 8px;
		height: 16px;
		font-size: 12px;
		line-height: 16px;
		border-radius: 8px;
		background-color: $upload-progress;
		display: inline-block;
		word-break: keep-all;
		color: var(--skin-color-secondary, $secondary);
		align-self: flex-end;
		margin: 5px 0 auto;
	}

	&__subject {
		font-size: $font-size-tertiary;
		line-height: 20px;
		white-space: nowrap;
		overflow: hidden;
		text-overflow: ellipsis;
		align-content: center;

		&--aliasMessage {
			font-style: italic !important;
		}

		& > span {
			display: inline-block;
			font-style: normal;
			font-weight: $font-weight-bold;
		}

		&__attachment {
			margin-right: $grid-base;

			svg {
				width: $icon-size-small;
				height: $icon-size-small;

				* {
					fill: var(--skin-color-secondary-contrast-safe, $secondary);
				}
			}
		}
	}

	&__videoCallMessageIcon {
		margin-left: 4px;
		width: $icon-size-small;
		height: $icon-size-small;

		* {
			fill: var(--skin-color-secondary-contrast-safe, $secondary);
		}
	}

	&__consultingTypeIcon {
		margin-left: auto;
		display: flex;
		align-items: center;
		justify-content: center;
		flex-shrink: 0;
		margin-right: -12px;

		svg {
			width: $icon-size-small;
			height: $icon-size-small;

			* {
				fill: var(--skin-color-secondary-contrast-safe, $secondary);
			}
		}

		&--team,
		&--oneOnOne {
			// Additional styling if needed
			width: 100%;
			height: 38px;
		}
	}

	.tag {
		margin-left: $grid-base;
	}
}

.createChatItem {
	.sessionsListItem__row {
		min-height: 18px;
	}
}

.skeleton {
	&:hover {
		cursor: auto !important;

		.sessionsListItem__content {
			background-color: $white;
		}
	}

	&__item {
		background-color: $dark-grey;
		width: 100%;
		min-height: 18px;
		background: linear-gradient(
			-90deg,
			$dark-grey 0%,
			$session-list-item-background-active 50%,
			$dark-grey 100%
		);
		background-size: 400% 400%;
		animation: pulse 1.2s ease-in-out infinite;

		@keyframes pulse {
			0% {
				background-position: 0;
			}

			100% {
				background-position: -135% 0%;
			}
		}
	}

	.sessionsListItem {
		&__consultingType {
			width: 45%;
		}

		&__icon {
			width: $icon-size;
		}

		&__subject {
			width: 80%;
		}

		&__date {
			margin-left: $grid-base-two;
			min-width: unset;
			width: 25%;
		}
	}
}

.sessionsList__itemsWrapper {
	.skeleton {
		margin-top: 0;
	}
}
